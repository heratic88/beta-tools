import{_ as g,o as d,c as r,e as a,a as l,f as c,g as h,w as v,d as w,h as u,t as y,p as b,i as k}from"./index.262e9f5e.js";const x={props:{imageUrl:String,videoUrl:String,xPercent:Number,yPercent:Number,alwaysVisible:Boolean},data(){return{visible:!1,imageLoaded:!1,dotPositioned:!1,imageWidth:null,imageHeight:null,offsetX:null,offsetY:null,startTime:null,duration:null,interacted:!1}},computed:{isLoaded(){return this.imageLoaded&&this.dotPositioned},dotX(){return this.offsetX+this.imageWidth*(this.xPercent/100)-4},dotY(){return this.offsetY+this.imageHeight*(this.yPercent/100)-4},friendlyDuration(){if(!!this.duration)return`${(this.duration/1e3).toFixed(2)} sec`}},methods:{onLoadImage(){this.imageLoaded=!0,this.$nextTick(()=>{const s=this.$refs.image.getBoundingClientRect();this.imageWidth=s.width,this.imageHeight=s.height,this.offsetX=s.left,this.offsetY=s.top,this.positionDot()})},onLoadVideo(){this.imageLoaded=!0,this.checkInteraction(),this.$nextTick(()=>{const s=this.$refs.video.getBoundingClientRect();this.imageWidth=s.width,this.imageHeight=s.height,this.offsetX=s.left,this.offsetY=s.top,this.positionDot()})},checkInteraction(){this.imageLoaded&&this.interacted&&this.$refs.video.play().then(()=>this.$refs.video.pause())},interact(){this.interacted=!0,this.$nextTick(()=>this.checkInteraction())},positionDot(){this.$refs.dot.style.left=`${this.dotX}px`,this.$refs.dot.style.top=`${this.dotY}px`,this.dotPositioned=!0},mouseDown(s){s.which===1?this.show():(this.hide(),this.duration=null)},show(){this.visible=!0,this.startTime=performance.now(),this.$refs.video&&this.$refs.video.play()},hide(){this.visible=!1,this.duration=performance.now()-this.startTime,this.startTime=null,this.$refs.video&&(this.$refs.video.pause(),this.$refs.video.currentTime=0)},touchStart(){this.visible=!0,this.startTime=performance.now(),this.$nextTick(()=>{this.$refs.video&&this.$refs.video.play()})},clickImage(s){this.$emit("clickImage",s)}},watch:{xPercent(){this.positionDot()},yPercent(){this.positionDot()}}},f=s=>(b("data-v-6f2ae5dd"),s=s(),k(),s),p={class:"flex fixed items-center justify-center top-0 left-0 bottom-0 right-0"},L={key:0,class:"fixed top-0 left-0 bottom-0 right-0 z-40"},D=["src"],T=["src"],_={class:"dot",ref:"dot"},I={key:1,class:"text-white text-4xl"},V=u(" Focus your eyes on the red dot, then tap and hold to reveal the image "),S=f(()=>l("br",null,null,-1)),P=u(" Don't move your eyes! Let go as soon as you do "),R={key:0},C=f(()=>l("br",null,null,-1));function U(s,t,o,m,n,e){return d(),r("div",null,[o.videoUrl&&!n.interacted?(d(),r("button",{key:0,class:"fixed top-0 left-0 bottom-0 right-0 z-10 bg-black text-white",onClick:t[0]||(t[0]=(...i)=>e.interact&&e.interact(...i))}," Tap to load the eye contact challenge ")):a("",!0),l("button",{class:"fixed top-0 left-0 bottom-0 right-0",onMousedown:t[5]||(t[5]=(...i)=>e.mouseDown&&e.mouseDown(...i)),onMouseup:t[6]||(t[6]=(...i)=>e.hide&&e.hide(...i)),onTouchstart:t[7]||(t[7]=h((...i)=>e.touchStart&&e.touchStart(...i),["prevent"])),onTouchend:t[8]||(t[8]=h((...i)=>e.hide&&e.hide(...i),["prevent"]))},[l("div",p,[o.alwaysVisible?a("",!0):(d(),r("div",L)),o.imageUrl?(d(),r("img",{key:1,src:o.imageUrl,class:c(["image object-cover overflow-hidden h-full z-20",{"opacity-0":!n.visible,"opacity-100":n.visible||o.alwaysVisible}]),onLoad:t[1]||(t[1]=(...i)=>e.onLoadImage&&e.onLoadImage(...i)),onClick:t[2]||(t[2]=(...i)=>e.clickImage&&e.clickImage(...i)),ref:"image"},null,42,D)):a("",!0),o.videoUrl?(d(),r("video",{key:2,class:c(["object-cover overflow-hidden h-full z-20",{"opacity-0":!n.visible,"opacity-100":n.visible||o.alwaysVisible}]),onCanplaythrough:t[3]||(t[3]=(...i)=>e.onLoadVideo&&e.onLoadVideo(...i)),onClick:t[4]||(t[4]=(...i)=>e.clickImage&&e.clickImage(...i)),ref:"video",loop:"",preload:"auto"},[l("source",{src:o.videoUrl},null,8,T)],34)):a("",!0)])],32),v(l("div",_,null,512),[[w,n.dotPositioned&&!n.visible||o.alwaysVisible]]),e.isLoaded?a("",!0):(d(),r("div",I,"Loading, please wait...")),e.isLoaded&&!n.visible&&!o.alwaysVisible?(d(),r("div",{key:2,class:"text-white text-2 fixed bottom-4 left-16 right-16 text-center",onMousedown:t[9]||(t[9]=(...i)=>e.mouseDown&&e.mouseDown(...i)),onMouseup:t[10]||(t[10]=(...i)=>e.hide&&e.hide(...i)),onTouchstart:t[11]||(t[11]=h((...i)=>e.touchStart&&e.touchStart(...i),["prevent"])),onTouchend:t[12]||(t[12]=h((...i)=>e.hide&&e.hide(...i),["prevent"]))},[V,S,P,n.duration?(d(),r("div",R,[C,u("You lasted "+y(e.friendlyDuration),1)])):a("",!0)],32)):a("",!0)])}const Y=g(x,[["render",U],["__scopeId","data-v-6f2ae5dd"]]);async function j(s){if(!!s){if(s.startsWith("https://www.redgifs.com/watch/")){const t=new URL(s).pathname.split("/")[2],n={Authorization:`Bearer ${(await(await fetch("https://api.redgifs.com/v2/auth/temporary")).json()).token}`,"Content-Type":"application/json"},i=(await(await fetch(`https://api.redgifs.com/v2/gifs/${t}`,{headers:n,mode:"cors"})).json()).gif.urls;return i.hd||i.sd}return s}}export{Y as R,j as b};
