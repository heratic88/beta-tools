import{_ as g,o as r,c as d,e as a,a as h,f as c,g as l,w as v,d as w,h as u,t as y,p as b,i as k}from"./index.79a36c0d.js";const x={props:{imageUrl:String,videoUrl:String,xPercent:Number,yPercent:Number,alwaysVisible:Boolean},data(){return{visible:!1,imageLoaded:!1,dotPositioned:!1,imageWidth:null,imageHeight:null,offsetX:null,offsetY:null,startTime:null,duration:null,interacted:!1,needsInteraction:!0}},computed:{isLoaded(){return this.imageLoaded&&this.dotPositioned},dotX(){return this.offsetX+this.imageWidth*(this.xPercent/100)-4},dotY(){return this.offsetY+this.imageHeight*(this.yPercent/100)-4},friendlyDuration(){if(!!this.duration)return`${(this.duration/1e3).toFixed(2)} sec`}},methods:{onLoadImage(){this.imageLoaded=!0,this.$nextTick(()=>{const s=this.$refs.image.getBoundingClientRect();this.imageWidth=s.width,this.imageHeight=s.height,this.offsetX=s.left,this.offsetY=s.top,this.positionDot()})},onLoadVideo(){this.imageLoaded=!0,this.checkInteraction(),this.$nextTick(()=>{const s=this.$refs.video.getBoundingClientRect();this.imageWidth=s.width,this.imageHeight=s.height,this.offsetX=s.left,this.offsetY=s.top,this.positionDot()})},checkInteraction(){this.imageLoaded&&this.interacted&&this.needsInteraction&&(this.$refs.video.play().then(()=>this.$refs.video.pause()),this.needsInteraction=!1)},interact(){this.interacted=!0,this.$nextTick(()=>this.checkInteraction())},positionDot(){this.$refs.dot.style.left=`${this.dotX}px`,this.$refs.dot.style.top=`${this.dotY}px`,this.dotPositioned=!0},mouseDown(s){s.which===1?this.show():(this.hide(),this.duration=null)},show(){this.visible=!0,this.startTime=performance.now(),this.$refs.video&&this.$refs.video.play()},hide(){this.visible=!1,this.duration=performance.now()-this.startTime,this.startTime=null,this.$refs.video&&(this.$refs.video.pause(),this.$refs.video.currentTime=0)},timeChange(s){!this.$refs.video.paused&&this.visible&&this.$refs.video.currentTime==0&&this.$nextTick(()=>this.$refs.video.play())},touchStart(){this.visible=!0,this.startTime=performance.now(),this.$nextTick(()=>{this.$refs.video&&this.$refs.video.play()})},clickImage(s){this.$emit("clickImage",s)}},watch:{xPercent(){this.positionDot()},yPercent(){this.positionDot()}}},f=s=>(b("data-v-203eab97"),s=s(),k(),s),p={class:"flex fixed items-center justify-center top-0 left-0 bottom-0 right-0"},T={key:0,class:"fixed top-0 left-0 bottom-0 right-0 z-40"},I=["src"],L=["src"],D={class:"dot",ref:"dot"},_={key:1,class:"text-white text-4xl"},V=u(" Focus your eyes on the red dot, then tap and hold to reveal the image "),C=f(()=>h("br",null,null,-1)),S=u(" Don't move your eyes! Let go as soon as you do "),P={key:0},R=f(()=>h("br",null,null,-1));function U(s,t,o,m,n,e){return r(),d("div",null,[o.videoUrl&&!n.interacted?(r(),d("button",{key:0,class:"fixed top-0 left-0 bottom-0 right-0 z-10 bg-black text-white",onClick:t[0]||(t[0]=(...i)=>e.interact&&e.interact(...i))}," Tap to load the eye contact challenge ")):a("",!0),h("button",{class:"fixed top-0 left-0 bottom-0 right-0",onMousedown:t[6]||(t[6]=(...i)=>e.mouseDown&&e.mouseDown(...i)),onMouseup:t[7]||(t[7]=(...i)=>e.hide&&e.hide(...i)),onTouchstart:t[8]||(t[8]=l((...i)=>e.touchStart&&e.touchStart(...i),["prevent"])),onTouchend:t[9]||(t[9]=l((...i)=>e.hide&&e.hide(...i),["prevent"]))},[h("div",p,[o.alwaysVisible?a("",!0):(r(),d("div",T)),o.imageUrl?(r(),d("img",{key:1,src:o.imageUrl,class:c(["image object-cover overflow-hidden h-full z-20",{"opacity-0":!n.visible,"opacity-100":n.visible||o.alwaysVisible}]),onLoad:t[1]||(t[1]=(...i)=>e.onLoadImage&&e.onLoadImage(...i)),onClick:t[2]||(t[2]=(...i)=>e.clickImage&&e.clickImage(...i)),ref:"image"},null,42,I)):a("",!0),o.videoUrl?(r(),d("video",{key:2,class:c(["object-cover overflow-hidden h-full z-20",{"opacity-0":!n.visible,"opacity-100":n.visible||o.alwaysVisible}]),onCanplaythrough:t[3]||(t[3]=(...i)=>e.onLoadVideo&&e.onLoadVideo(...i)),onClick:t[4]||(t[4]=(...i)=>e.clickImage&&e.clickImage(...i)),onTimeupdate:t[5]||(t[5]=(...i)=>e.timeChange&&e.timeChange(...i)),ref:"video",loop:"",preload:"auto"},[h("source",{src:o.videoUrl},null,8,L)],34)):a("",!0)])],32),v(h("div",D,null,512),[[w,n.dotPositioned&&!n.visible||o.alwaysVisible]]),e.isLoaded?a("",!0):(r(),d("div",_,"Loading, please wait...")),e.isLoaded&&!n.visible&&!o.alwaysVisible?(r(),d("div",{key:2,class:"text-white text-2 fixed bottom-4 left-16 right-16 text-center",onMousedown:t[10]||(t[10]=(...i)=>e.mouseDown&&e.mouseDown(...i)),onMouseup:t[11]||(t[11]=(...i)=>e.hide&&e.hide(...i)),onTouchstart:t[12]||(t[12]=l((...i)=>e.touchStart&&e.touchStart(...i),["prevent"])),onTouchend:t[13]||(t[13]=l((...i)=>e.hide&&e.hide(...i),["prevent"]))},[V,C,S,n.duration?(r(),d("div",P,[R,u("You lasted "+y(e.friendlyDuration),1)])):a("",!0)],32)):a("",!0)])}const Y=g(x,[["render",U],["__scopeId","data-v-203eab97"]]);async function j(s){if(!!s){if(s.startsWith("https://www.redgifs.com/watch/")){const t=new URL(s).pathname.split("/")[2],n={Authorization:`Bearer ${(await(await fetch("https://api.redgifs.com/v2/auth/temporary")).json()).token}`,"Content-Type":"application/json"},i=(await(await fetch(`https://api.redgifs.com/v2/gifs/${t}`,{headers:n,mode:"cors"})).json()).gif.urls;return i.hd||i.sd}return s}}export{Y as R,j as b};
